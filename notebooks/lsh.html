
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Locality Sensitive Hashing (LSH) &#8212; Probabilistic Algorithms and Data Structures</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Randomized Routing" href="randomized_routing.html" />
    <link rel="prev" title="Ideas behind many probabilistic data structures" href="intro_hashing.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Probabilistic Algorithms and Data Structures</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Probabilistic Algorithms and Data Structures
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../content.html">
   Contents
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="intro_hashing.html">
     <strong>
      Ideas behind many probabilistic data structures
     </strong>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Locality Sensitive Hashing (LSH)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="randomized_routing.html">
     <strong>
      Randomized Routing
     </strong>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/lsh.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnotebooks/lsh.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/notebooks/lsh.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#near-neighbour-search-nn">
   Near Neighbour Search (NN)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#approximate-near-neighbour-search-ann">
   Approximate Near Neighbour Search (ANN)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lsh-introduction">
   LSH - Introduction
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="locality-sensitive-hashing-lsh">
<h1>Locality Sensitive Hashing (LSH)<a class="headerlink" href="#locality-sensitive-hashing-lsh" title="Permalink to this headline">¶</a></h1>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>NOTATION</p></th>
<th class="head"><p>DESCRIPTION</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(d\)</span></p></td>
<td><p>dimension</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mathcal{D}\)</span></p></td>
<td><p>Distance function</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mathcal{S}\)</span></p></td>
<td><p>Similarity function</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(q\)</span></p></td>
<td><p>query object</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(q^*\)</span></p></td>
<td><p>object nearest to query</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x\)</span></p></td>
<td><p>general object</p></td>
</tr>
</tbody>
</table>
<p>In the previous lectures, we have seen how the problem of efficient exact-search (or related problems like set membership) etc can be solved using hash tables. Also, we saw how memory and computation efficient algorithms can be built if we are ready to sacrifice some accuracy like with bloom filters for set membership problem. However, a lot of practical applications demand for some tolerance in search. For example, while searching a data base of products for a specific product, say “nike shoes model no.831533-001”, a user might trigger various queries with the same intention such as “nike shoes”, “nike running shoes”, “nike shoes latest”, “nike shoes black” etc. The expectation is to recieve a list of products related to the query and not the exact query.</p>
<p>Abstractly,a relevant problem in information retrieval is that of “near neighbour search” or “finding elements from a set that are similar to a query element”. Generally the notion of nearness (or corresponding similarity) can be specified using distance function, <span class="math notranslate nohighlight">\(\mathcal{D}\)</span>, ( or corresponding similarity function, <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>). As a solution to this problem, we want to find the element that is closest (or most similar) to the query element according to the given function (<span class="math notranslate nohighlight">\(\mathcal{D}\)</span> or <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>. We formally define the problem of near neighbour search as follows.</p>
<div class="section" id="near-neighbour-search-nn">
<h2>Near Neighbour Search (NN)<a class="headerlink" href="#near-neighbour-search-nn" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Given a collection of n objects, say <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> and a query object <span class="math notranslate nohighlight">\(q\)</span> and a distance metric <span class="math notranslate nohighlight">\(\mathcal{D}\)</span> ( or similarity metric <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>), the near neighbour problem is to find the element in set <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> that is closest to <span class="math notranslate nohighlight">\(q\)</span> according to <span class="math notranslate nohighlight">\(\mathcal{D}\)</span> (or <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>). Formally,</p>
<div class="math notranslate nohighlight">
\[ q^* = \textrm{arg} \min_{x \in \mathcal{C}} \mathcal{D}(q, x) \quad \textrm{or} \quad q^* = \textrm{arg} \max_{x \in \mathcal{C}} \mathcal{S}(q, x) \]</div>
<hr class="docutils" />
<p><span style="color: red;">todo: does D have to be a metric? Does S have to be a positive semi-definite kernel? </span>
The similarity function, <span class="math notranslate nohighlight">\(\mathcal{S}(x,y)\)</span> is also sometimes referred to as kernel function denoted by <span class="math notranslate nohighlight">\(k(x,y)\)</span> or <span class="math notranslate nohighlight">\(\phi(x,y)\)</span>. A realted problem is that of finding the K near neighbours(KNN).</p>
<p>A naive algorithm to solve NN is to compute the distance <span class="math notranslate nohighlight">\(\mathcal{D}(x, q)\)</span> for every x in <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> and find the element with minimum <span class="math notranslate nohighlight">\(\mathcal{D}(q,x)\)</span>. This is <span class="math notranslate nohighlight">\(\mathcal{O}(n)\)</span> in computation of distance. One can also check that this is the lower bound on complexity as we have to compare the distances for all of the objects in <span class="math notranslate nohighlight">\(\mathcal{C}\)</span>. Another setup of the problem is that we have the set <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> fixed and we plan to make a lot of queries, <span class="math notranslate nohighlight">\(\{q_i\}_{i=1}^t\)</span>. In such a setup, it is wise to construct a datastructure which can help us answer these queries efficiently. When the objects are actually vectors in <span class="math notranslate nohighlight">\(R^d\)</span> for some d, some space paritioning methods are used to create an efficient datastructure. <span style="color: red;">[cite algorithms] </span>. However, these datastructures suffer from the curse of dimensionality <span style="color: red;">[explain] </span>. and hence do not scale to higher dimensions. In order to find an efficient solution to the problem, we once again relax the problem in a way that it’s practical utility is maintained. This problem is known as the Approximate Near Neighbour(ANN) search</p>
</div>
<div class="section" id="approximate-near-neighbour-search-ann">
<h2>Approximate Near Neighbour Search (ANN)<a class="headerlink" href="#approximate-near-neighbour-search-ann" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<p>Given a collection of n objects, say <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> and a query object <span class="math notranslate nohighlight">\(q\)</span>, a distance metric <span class="math notranslate nohighlight">\(\mathcal{D}\)</span> ( or similarity metric <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>) and a error tolerance <span class="math notranslate nohighlight">\(\epsilon\)</span>, the approximate near neighbour problem is to find the element in set <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> that is within a distance of <span class="math notranslate nohighlight">\((1+\epsilon)\mathcal{D}(q^*, q)\)</span> where <span class="math notranslate nohighlight">\(q^*\)</span> is the closest element</p>
<div class="math notranslate nohighlight">
\[ q^+ \quad s.t. \quad \mathcal{D}(q^+,q) &lt; (1 + \epsilon) \mathcal{D}(q^*,q) \quad \textrm{or} \quad \mathcal{S}(q^+, q) &gt; (1-\epsilon) \mathcal{S}(q^*,q) \]</div>
<hr class="docutils" />
<p>In an adaptation of the problem, we might be interested in all the points that lie within a distance from the query point q or the points which have a similarity greator than a particular threshold.</p>
<blockquote>
<div><p>Note: In all the following material we will stick to the Similarity notion for near neighbour discussion. However, it should be noted that the two notions are inter-changeable.</p>
</div></blockquote>
</div>
<div class="section" id="lsh-introduction">
<h2>LSH - Introduction<a class="headerlink" href="#lsh-introduction" title="Permalink to this headline">¶</a></h2>
<p>Let us reflect on how we solved efficient search with hash-tables. Using a hash function, we can reduce the search space for a particular query by orders of magnitude. Specifically, we only have to compare the query against the elements that have same hash values and are stored together in memory. The hash function we used there was a random hash function as we had two conditions : (1) Each element x is consistently mapped to a location (which is a given since the mapping is a function) (2) Distinct elements collide as less as possible (as you cannot avoid collisions completely.)</p>
<p>A key issue with using the same hash function as above for this problem is that the hash function will not distinguish between two elements y and z on the basis of how similar they are to x. All that matters for this hash function is whether two elements are exacty same or not. If we were to design hash function such that similar elements match together, then we can hope to efficiently solve the problem.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="intro_hashing.html" title="previous page"><strong>Ideas behind many probabilistic data structures</strong></a>
    <a class='right-next' id="next-link" href="randomized_routing.html" title="next page"><strong>Randomized Routing</strong></a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Aditya Desai, Anshumali Shrivastava<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>